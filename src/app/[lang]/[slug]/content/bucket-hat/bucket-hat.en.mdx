---
title: "Bucket Hat Pattern Generator"
date: "2025-03-15"
slug: "bucket-hat"
---

## Introduction

This project allows users to generate sewing patterns for bucket hats based on input parameters such as size, shape, and seam allowance. It also features a 3D preview of the generated hat with physics simulation.

The goal is to provide an understanding of the final product before cutting and sewing. One of the main challenges for hobbyist sewers is visualizing the final look of a hat just from a pattern. Small changes in length and angles can significantly impact the final shape.

I decided to build this project because I have sewn several bucket hats for personal use and gifting. Bucket hats come in a wide variety of shapes, and it is difficult to predict their appearance just by looking at the pattern. For example, the curvature of the brim arc affects how much the brim flares outward. The angles formed by these curvatures are difficult to visualize without physically cutting and assembling the pieces. Three-dimensional garments, such as hats, suffer greatly from this challenge, which is why I created this tool.

## Target Audience

The primary target audience for this tool is beginner hobbyists who struggle to find free patterns or make their own. My goal was to create a comprehensive tool capable of generating all possible sizes and shapes for a basic bucket hat. However, as a procedural generation tool, it also enables experimental testing for intermediate and advanced sewers. With the tool's ability to calculate precise patterns and simulate different fabric weights and stiffness levels, users can experiment with various designs.

## Features & Functionality

This project includes a configuration panel with parameter inputs, a 3D model of the hat with cloth simulation, and a preview of the sewing pattern. Users can input measurements such as head diameter, head height, brim width, brim angle, and seam allowance. The sewing pattern and 3D model are dynamically generated based on these inputs and update in real time for an interactive experience.

The 3D model incorporates a physics engine to simulate how the hat sits on a head. Users can adjust physics parameters such as fabric stiffness, weight, and gravity. The finalized sewing pattern can be exported to a PDF in the desired paper size.

### Technologies Used

- **Next.js** – Framework
- **Three.js** – 3D rendering
- **React Three Fiber** – React renderer for Three.js
- **Cannon.js** – Physics engine
- **jsPDF** – PDF generation
- **svg2pdf** – SVG to PDF conversion (jsPDF plugin)
- **D3.js** – SVG generation
- **Firebase** – Feedback database
- **Figma** – Design
- **react-tooltips** – Tooltips

## Design & UX

I drew inspiration from old-school sewing books, line drawing aesthetics, and mid-century modern electronics, particularly Dieter Rams’ designs. The interactive UI elements have distinct borders and drop shadows to indicate interactivity. The wordmark is set in **EB Garamond**, while headings and paragraphs use **Inter**.

The desktop layout follows a standard configuration setup—a large view with a panel on one side. One of the main challenges in responsive design was creating a user-friendly layout for mobile devices. Since mobile screens are too small to divide into panel and view sections, a compact interactive zone could hinder usability. To address this, I implemented a floating viewport for the 3D preview once the page is scrolled down. Although the floating viewport covers part of the interactive area, users can still perceive the underlying elements through the uncovered sections.

## Development Process

I started by developing the core functionality—taking input parameters (head diameter, height, brim width, angle) and using them to calculate the necessary values for generating a sewing pattern. I used D3.js to draw the pattern and implemented shape-modifying functions, such as offsetting and centering shapes. For PDF generation, I used jsPDF, along with the svg2pdf plugin for SVG integration.

Next, I developed the 3D previews and physics simulations, which make this project unique. The drawing and exporting of the pattern were my initial focus before incorporating the physics engine.

## Calculating the Hat Dimensions

A bucket hat consists of two truncated cones: the head (band) and the brim. The headpiece also has a top cap (crown). To allow for more control over the hat’s shape, I included head ratio parameters to adjust the eccentricity of the head when viewed from above.

Various calculations generate the 3D model and sewing pattern based on input parameters:

### Input Parameters and Calculated Variables

- **Head Circumference**
- **Head Height**
- **Head Ratio**
- **Brim Width**
- **Brim Angle**
- **Head Cone Major Axis (A), Minor Axis (B)**
- **Head Cone Height**
- **Head Cone Development Sector Angle**
- **Brim Cone Major Axis (A), Minor Axis (B)**
- **Brim Cone Height**
- **Brim Cone Development Sector Angle**
- **Brim Base Offset**
- **Crown Major Axis (A), Minor Axis (B)**

To determine the major (A) and minor (B) axes of an ellipse based on a given circumference and A/B ratio, I first needed the formula for calculating an ellipse's circumference. However, there is no exact formula—only approximations. One of the most accurate approximations was derived by mathematician **Srinivasa Ramanujan**, with an error margin of just 0.000005%.

Due to the complexity of this equation, I couldn't easily invert it to solve for the axes, so I opted for an iterative approach, comparing it with Ramanujan’s equation within an acceptable tolerance.

Another mathematical challenge arose in determining the sector angle (pizza slice) for pattern development. For a circular cone, the sector angle follows the formula:

Since I lacked a mathematical breakthrough of my own, I averaged the sector angles calculated using the major and minor axes. While this approach produces errors at higher eccentricities, the deviation remains within **5–10mm**, which is negligible given the flexibility of fabric and sewing tolerances.

## Drawing the Development

Drawing radial shapes involves plotting points from a fixed center and using angles to determine their positions.

For an elliptical cone, the slant length varies at different angles. I calculated the slant at small increments of **2π/segments** (where `segments` defines the detail level of the arc). Instead of using a fixed radius, I used the calculated slant as the distance from the center.

For the two truncated elliptical cones (head and brim), I applied the arc function twice. With these functions in place, I was ready to generate the sewing patterns and the crown ellipse.

## Exporting the Pattern

jsPDF was an excellent tool for generating dynamic PDFs, supporting text, images, and SVGs via plugins. However, one feature I wished for was the ability to add elements to an existing PDF file, which would have made template creation easier. Unfortunately, due to the complexity of the PDF format, there is no universal way to modify its content dynamically.

## Creating the Mesh

## 3D Simulation

The physics simulation enhances users' understanding of the hat’s characteristics. While the simulation may not be entirely accurate, it provides a better sense of how the generated hat will behave when worn.

The simulation consists of two worlds:

1. **Graphics World** – Powered by Three.js, responsible for generating and rendering the 3D model with lighting.
2. **Physics World** – A separate simulation that mirrors the 3D model and applies physics calculations.

By integrating these two systems, the tool provides a dynamic and interactive experience for designing and visualizing bucket hats.
